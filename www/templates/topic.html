<ion-view id="topic-detail" can-swipe-back="false">
  <ion-nav-bar class="bar-stable flat">
    <ion-nav-back-button>
    </ion-nav-back-button>
    <ion-nav-buttons side="right">
      <button class="button button-icon button-clear mdi mdi-dots-vertical flat">
      </button>
    </ion-nav-buttons>
  </ion-nav-bar>
  <ion-content>
    <div class="list">
      <a class="item item-avatar" ui-sref="app.user({ login: vm.topic.user.login })">
        <img ng-src="{{vm.topic.user.avatar_url}}" alt="{{ vm.topic.user.login }}">
        <!-- <ionic-letter-avatar data="{{ vm.topic.user.login }}" shape="round"></ionic-letter-avatar> -->
        <h2>
          {{ vm.topic.user.login }}
          <span class="pull-right dark">{{ vm.topic.created_at | date: 'MM月dd日' }}</span>
        </h2>
      </a>
      <div class="item">
        <h3>{{ vm.topic.title }}</h3>
      </div>
      <div class="item item-narrow gray">
        <span class="pull-left">
          <i class="mdi mdi-thumb-up"></i> {{ vm.topic.likes_count }} 个赞
        </span>
        <span class="pull-right">
          <i class="mdi mdi-message-reply"></i> {{ vm.topic.replies_count }} 条回复
        </span>
      </div>
      <div class="item">
        <div class="markdown" ng-bind-html="vm.topic.body_html | externalLinks"></div>
      </div>
      <div class="item-divider replies-divider">
      </div>
      <div class="item item-narrow reply" ng-repeat="reply in vm.replies">
        <div class="row" ng-if="reply.deleted">
          <div class="col">
            <div class="text text-deleted text-center">
              {{ $index + 1 }} 楼已删除
            </div>
          </div>
        </div>
        <div class="row" ng-if="!reply.deleted">
          <div class="col item-avatar">
            <img ng-src="{{reply.user.avatar_url}}" alt="{{ reply.user.login }}">
            <h2>
              {{ reply.user.login }}
              <span class="pull-right gray">
                #{{ $index +1 }}
                <span class="dark">{{ reply.created_at | date: 'MM月dd日' }}</span>
              </span>
            </h2>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="markdown" ng-bind-html="reply.body_html | externalLinks"></div>
          </div>
        </div>
      </div>
    </div>
  </ion-content>
  <button class="button button-fab button-fab-bottom-right button-assertive icon mdi mdi-reply" ng-click="vm.showReplyModal()"></button>
</ion-view>
